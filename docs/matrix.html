<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html>
<head>
<meta http-equiv="Cache-Control" content="no-cache, no-store, must-revalidate">
<meta http-equiv="Pragma" content="no-cache">
<meta http-equiv="Expires" content="0"><meta http-equiv="Content-Language" content="en-us">
<meta http-equiv="Content-Type" content=
"text/html; charset=us-ascii">
<title>muscle manual</title>
<link rel="stylesheet" type="text/css" href="manstyles.css">
<style>
<!--
h2
	{margin-top:12.0pt;
	margin-right:0in;
	margin-bottom:3.0pt;
	margin-left:0in;
	text-indent:0in;
	page-break-after:avoid;
	font-size:12.0pt;
	font-family:"Arial","sans-serif";
	font-weight:normal;
	}
 p.MsoNormal
	{mso-style-parent:"";
	margin-bottom:.0001pt;
	font-size:10.0pt;
	font-family:"Times New Roman","serif";
	margin-left:0in; margin-right:0in; margin-top:0in}
p.Code
	{margin-top:0in;
	margin-right:0in;
	margin-bottom:0in;
	margin-left:.25in;
	margin-bottom:.0001pt;
	font-size:9.0pt;
	font-family:"Courier New";
	}
-->
</style>
<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-50117757-1', 'auto');
  ga('send', 'pageview');

</script>

</head>
<body bgcolor="#E1E1E1">
<div align="center">&nbsp;
<table border="0" width="735" cellspacing="0" cellpadding="5"
bgcolor="#FFFFFF">
<tr>
<td bgcolor="#E1E1E1"><span class="ManPath"><a href=
 "index.html"><font face="Arial">MUSCLE manual</font></a></span></td>
</tr>
<tr>
<td bgcolor="#006600"><span class="ManTopic">Using a custom substitution matrix</span></td>
</tr>
<tr>
<td>
<p style="margin-left:0in;text-indent:0in"><b><font face="Arial" size="2">&nbsp;<br>
Specifying a protein substitution matrix</font></b><br>
<font face="Arial" size="2">You can specify your own substitution matrix by 
using the -matrix option. This reads a protein substitution matrix in NCBI or 
WU-BLAST format. The alphabet is assumed to be amino acid, and sum-of-pairs 
scoring is used. The &shy;-gapopen, -gapextend and -center parameters should be 
specified; normally you will specify a zero value for the center. Note that gap 
penalties MUST be negative. The environment variable MUSCLE_MXPATH can be used 
to specify a path where the matrices are stored. For example,</font></p>
<p><font face="Arial" size="2">muscle -in seqs.fa -out seqs.afa -matrix 
/data/matrix/blosum62 -gapopen -12.0 -gapextend -1.0 -center 0.0</font></p>
<p><font face="Arial" size="2">Example matrices can be downloaded from the NCBI 
FTP site. At the time of writing they are found here:</font></p>
<p><font face="Arial" size="2">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
<a style="color: blue; text-decoration: underline; text-underline: single" href="ftp://ftp.ncbi.nih.gov/blast/matrices/">
ftp://ftp.ncbi.nih.gov/blast/matrices/</a></font></p>
<p style="margin-left:0in;text-indent:0in"><b><font face="Arial" size="2">
Specifying a nucleotide substitution matrix</font></b><br>
<font face="Arial" size="2">MUSCLE isn't really designed to support a nucleotide 
matrix, but you can hack it by pretending that AGCT are amino acids and making a 
20x20 matrix out of the original 4x4 matrix. You MUST specify the -seqtype 
protein option to fool MUSCLE into believing that it is aligning amino acid 
sequences.The ACGT rows and columns should have your desired nucleotide
        values, the other entries should be zero. Values can be integers or
        floating-point. In the following example, integers are used with a match
        score of +1 and a mismatch score of -2 (these are the BLASTN defaults).
</font></p>
        <p><font face="Arial" size="2"><a href="http://www.drive5.com/muscle/nucmx">Download
        an example matrix here</a>.<br>
        &nbsp;<br>
        Use the following options:</font></p>
        <p><font face="Arial" size="2">&nbsp;&nbsp;&nbsp; -matrix &lt;filename&gt; -seqtype
        protein<br>
&nbsp;</font></td>
</tr>
</table>
</div>
</body>
</html>