<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html>
<head>
<meta http-equiv="Cache-Control" content="no-cache, no-store, must-revalidate">
<meta http-equiv="Pragma" content="no-cache">
<meta http-equiv="Expires" content="0"><meta http-equiv="Content-Language" content="en-us">
<meta http-equiv="Content-Type" content=
"text/html; charset=us-ascii">
<title>USEARCH manual</title>
<link rel="stylesheet" type="text/css" href="manstyles.css">
<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-50117757-1', 'auto');
  ga('send', 'pageview');

</script>

</head>
<body bgcolor="#E1E1E1">
<div align="center">&nbsp;
<table border="0" width="735" cellspacing="0" cellpadding="5"
bgcolor="#FFFFFF">
<tr>
<td bgcolor="#E1E1E1"><span class="ManPath"><a href=
 "index.html">USEARCH manual</a> &gt; Matrix warning</span></td>
</tr>
<tr>
<td bgcolor="#0000CC"><span class="ManTopic">Matrix is not symmetrical warning</span></td>
</tr>
<tr>
<td><span class="ManText">&nbsp;<br>
The symptom of this bug is a message like this:</span><p>
<span class="ManCode">&nbsp; *** WARNING *** Matrix is not symmetrical, ?-&gt;?=5, 
?-&gt;?=0</span></p>
<p><span class="ManIndText">A patch for this bug was kindly contributed by 
Robert Leach, who describes it as follows:</span><p><span class="ManIndText">I 
found 2 bugs in the readmx.cpp code in the current version of muscle. I 
submitted a patch to this bioconductor repo that includes muscle. You can see 
the details here:</span><p><span class="ManIndText">
<a href="https://github.com/Bioconductor-mirror/muscle/compare/master...hepcat72:patch-2">
https://github.com/Bioconductor-mirror/muscle/compare/master...hepcat72:patch-2</a> </span>
<p><span class="ManIndText">Basically, the last column of custom weight matrices 
being read in using the -matrix option were not being set and were generating 
the warnings I had asked about before. &nbsp;The warnings had contained unrecognized 
characters (which the terminal displayed as question marks) because CharToLetter 
was being called instead of LetterToChar. Once I fixed the warning and 
eliminated the loop exit, it was clear that the last column of the matrix was 
unset (all zeros). &nbsp;I found the loop where the matrix was being set and 
discovered that the `Col &lt; HeadingCount - 1` for the for loop should have been 
just `Col &lt; HeadingCount`. <br>&nbsp;</span></td>
</tr>
</table>
</div>
</body>
</html>
